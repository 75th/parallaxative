{"version":3,"sources":["scroller.js"],"names":["ScrollerAnimationValueSet","options","_this","this","_classCallCheck","defaultOptions","unit","valueFormat","substitutionString","startValue","endValue","Object","assign","getOwnPropertyNames","forEach","name","ScrollerAnimation","animateTargets","valueSets","properties","valueSetSeparator","length","listeners","scrollPosition","cssValues","valueSet","console","log","push","replace","toString","animateTarget","animateProperty","style","join","Scroller","scrollTarget","animations","scrollIsVertical","activeMediaQueryList","window","matchMedia","activated","respond","addEventListener","offset","size","windowSize","scrollPos","rect","getBoundingClientRect","top","document","documentElement","scrollTop","height","innerHeight","pageYOffset","left","scrollLeft","width","innerWidth","pageXOffset","zeroPoint","Math","min","max","relativeScrollPosition","_this2","animation","classList","add","updateCSS","clampedRelativeScrollPosition","setUpAnimations","listener","removeEventListener","matches","activate","deactivate"],"mappings":"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","file":"scroller.min.js","sourcesContent":["class ScrollerAnimationValueSet {\n\tconstructor(options) {\n\t\tvar defaultOptions = {\n\t\t\tunit: 'vh',\n\t\t\tvalueFormat: 'translateY(_)',\n\t\t\tsubstitutionString: '_',\n\t\t\tstartValue: 20,\n\t\t\tendValue: -20\n\t\t};\n\n\t\toptions = Object.assign({}, defaultOptions, options);\n\n\t\tObject.getOwnPropertyNames(options).forEach(name => {\n\t\t\tthis[name] = options[name];\n\t\t});\n\t}\n}\n\nclass ScrollerAnimation {\n\tconstructor(animateTargets, options, valueSets) {\n\t\tvar defaultOptions = {\n\t\t\tproperties: ['transform', 'msTransform'],\n\t\t\tvalueSetSeparator: ', '\n\t\t}\n\n\t\tif(typeof valueSets === 'undefined' || !valueSets.length) {\n\t\t\tvalueSets = [ new ScrollerAnimationValueSet ];\n\t\t}\n\n\t\tthis.options = Object.assign({}, defaultOptions, options);\n\t\tthis.valueSets = valueSets;\n\t\tthis.animateTargets = animateTargets;\n\t\tthis.listeners = [];\n\t}\n\n\tupdateCSS(scrollPosition) {\n\t\tvar cssValues = [];\n\n\t\tthis.valueSets.forEach(function (valueSet) {\n\t\t\tconsole.log(valueSet);\n\t\t\tcssValues.push(\n\t\t\t\tvalueSet.valueFormat.replace(valueSet.substitutionString, ((valueSet.endValue - valueSet.startValue) * scrollPosition + valueSet.startValue).toString() + valueSet.unit)\n\t\t\t);\n\t\t});\n\n\t\tthis.animateTargets.forEach(function(animateTarget) {\n\t\t\tthis.options.properties.forEach(function(animateProperty) {\n\t\t\t\tanimateTarget.style[animateProperty] = cssValues.join(this.options.valueSetSeparator);\n\t\t\t}, this);\n\t\t}, this);\n\t}\n}\n\nclass Scroller {\n\tconstructor(scrollTarget, options, animations) {\n\t\tvar defaultOptions = {\n\t\t\tscrollIsVertical: true,\n\t\t\tactiveMediaQueryList: window.matchMedia('(min-width: 720px)')\n\t\t};\n\n\t\tif(typeof animations === 'undefined') {\n\t\t\tanimations = [];\n\t\t}\n\n\t\tthis.scrollTarget = scrollTarget;\n\t\tthis.animations = animations;\n\t\tthis.options = Object.assign({}, defaultOptions, options);\n\t\tthis.activated = false;\n\n\t\tthis.respond();\n\n\t\tthis.options.activeMediaQueryList.addEventListener('change', function() {\n\t\t\tthis.respond()\n\t\t});\n\t}\n\n\trelativeScrollPosition() {\n\t\tvar offset, size, windowSize, scrollPos;\n\n\t\tvar rect = this.scrollTarget.getBoundingClientRect();\n\n\t\tif(this.options.scrollIsVertical) {\n\t\t\toffset = rect.top + document.documentElement.scrollTop;\n\t\t\tsize = rect.height;\n\t\t\twindowSize = window.innerHeight;\n\t\t\tscrollPos = window.pageYOffset;\n\t\t} else {\n\t\t\toffset = rect.left + document.documentElement.scrollLeft;\n\t\t\tsize = rect.width;\n\t\t\twindowSize = window.innerWidth;\n\t\t\tscrollPos = window.pageXOffset;\n\t\t}\n\n\t\tvar zeroPoint = offset - windowSize;\n\t\tvar completePoint = offset + size;\n\t\treturn (scrollPos - zeroPoint) / (completePoint - zeroPoint);\n\t}\n\n\tclampedRelativeScrollPosition() {\n\t\tconsole.log(Math.min(Math.max(this.relativeScrollPosition(), 0), 1));\n\t\treturn Math.min(Math.max(this.relativeScrollPosition(), 0), 1);\n\t}\n\n\tsetUpAnimations() {\n\t\tthis.animations.forEach(animation => {\n\t\t\tanimation.animateTargets.forEach(animateTarget => {\n\t\t\t\tanimateTarget.classList.add('scroll-animated');\n\t\t\t\tanimation.updateCSS(this.clampedRelativeScrollPosition())\n\n\t\t\t\tanimation.listeners.push(() => {\n\t\t\t\t\tanimation.updateCSS(this.clampedRelativeScrollPosition());\n\t\t\t\t});\n\n\t\t\t\twindow.addEventListener('scroll', animation.listeners[animation.listeners.length - 1]); // // FIXME: Throttle scroll to requestAnimationFrame\n\t\t\t});\n\t\t});\n\t}\n\n\tactivate() {\n\t\tif(!this.activated) {\n\t\t\tthis.setUpAnimations();\n\t\t\tthis.activated = true;\n\t\t}\n\t}\n\n\tdeactivate() {\n\t\tif(this.activated) {\n\t\t\tthis.animations.forEach(function(animation) {\n\t\t\t\tanimation.listeners.forEach(function(listener) {\n\t\t\t\t\twindow.removeEventListener('scroll', listener);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.activated = false;\n\t\t}\n\t}\n\n\trespond() {\n\t\tif(this.options.activeMediaQueryList.matches) {\n\t\t\tthis.activate();\n\t\t} else {\n\t\t\tthis.deactivate();\n\t\t}\n\t}\n}"]}