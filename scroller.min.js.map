{"version":3,"sources":["scroller.js"],"names":["ScrollerAnimationValueSet","options","_this","this","_classCallCheck","defaultOptions","unit","valueFormat","substitutionString","startValue","endValue","resetValue","Object","assign","getOwnPropertyNames","forEach","name","ScrollerAnimation","animateTargets","valueSets","properties","valueSetSeparator","removePropertyOnReset","length","listeners","ticking","scrollPosition","cssValues","_this2","animateTarget","animateProperty","style","join","_this3","valueSet","push","replace","toString","setCSS","_this4","requestAnimationFrame","updateCSS","_this5","property","removeProperty","Scroller","scrollTarget","animations","_this6","scrollIsVertical","activeMediaQueryList","window","matchMedia","activated","respond","addListener","offset","size","windowSize","scrollPos","scroll","rect","getBoundingClientRect","scrollY","pageYOffset","document","documentElement","scrollTop","body","top","height","innerHeight","scrollX","pageXOffset","scrollLeft","left","width","innerWidth","zeroPoint","console","log","Math","min","max","relativeScrollPosition","_this7","animation","classList","add","clampedRelativeScrollPosition","requestUpdate","addEventListener","setUpAnimations","listener","removeEventListener","reset","matches","activate","deactivate"],"mappings":"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","file":"scroller.min.js","sourcesContent":["class ScrollerAnimationValueSet {\n\tconstructor(options) {\n\t\tvar defaultOptions = {\n\t\t\tunit: 'vh',\n\t\t\tvalueFormat: 'translateY(_)',\n\t\t\tsubstitutionString: '_',\n\t\t\tstartValue: 20,\n\t\t\tendValue: -20,\n\t\t\tresetValue: 0\n\t\t};\n\n\t\toptions = Object.assign({}, defaultOptions, options);\n\n\t\tObject.getOwnPropertyNames(options).forEach(name => {\n\t\t\tthis[name] = options[name];\n\t\t});\n\t}\n}\n\nclass ScrollerAnimation {\n\tconstructor(animateTargets, options, valueSets) {\n\t\tvar defaultOptions = {\n\t\t\tproperties: ['transform', 'msTransform'],\n\t\t\tvalueSetSeparator: ', ',\n\t\t\tremovePropertyOnReset: true\n\t\t};\n\n\t\tif(typeof valueSets === 'undefined' || !valueSets.length) {\n\t\t\tvalueSets = [ new ScrollerAnimationValueSet ];\n\t\t}\n\n\t\tthis.options = Object.assign({}, defaultOptions, options);\n\t\tthis.valueSets = valueSets;\n\t\tthis.animateTargets = animateTargets;\n\t\tthis.listeners = [];\n\t\tthis.ticking = false;\n\t\tthis.scrollPosition = 0.5;\n\t}\n\n\tsetCSS(cssValues) {\n\t\tthis.animateTargets.forEach((animateTarget) => {\n\t\t\tthis.options.properties.forEach((animateProperty) => {\n\t\t\t\tanimateTarget.style[animateProperty] = cssValues.join(this.options.valueSetSeparator);\n\t\t\t});\n\t\t});\n\t}\n\n\tupdateCSS() {\n\t\tvar cssValues = [];\n\n\t\tthis.valueSets.forEach((valueSet) => {\n\t\t\tcssValues.push(\n\t\t\t\tvalueSet.valueFormat.replace(valueSet.substitutionString, ((valueSet.endValue - valueSet.startValue) * this.scrollPosition + valueSet.startValue).toString() + valueSet.unit)\n\t\t\t);\n\t\t});\n\n\t\tthis.setCSS(cssValues);\n\t\tthis.ticking = false;\n\t}\n\n\trequestUpdate(scrollPosition) {\n\t\tif(!this.ticking) {\n\t\t\tthis.scrollPosition = scrollPosition;\n\t\t\trequestAnimationFrame(() => { this.updateCSS() });\n\t\t}\n\n\t\tthis.ticking = true;\n\t}\n\n\treset() {\n\t\tif(this.removePropertyOnReset) {\n\t\t\tthis.animateTargets.forEach((animateTarget) => {\n\t\t\t\tthis.options.properties.forEach((property) => {\n\t\t\t\t\tanimateTarget.style.removeProperty(property)\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tvar cssValues = [];\n\n\t\t\tthis.valueSets.forEach((valueSet) => {\n\t\t\t\tcssValues.push(\n\t\t\t\t\tvalueSet.valueFormat.replace(valueSet.substitutionString, valueSet.resetValue.toString() + valueSet.unit)\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tthis.setCSS(cssValues);\n\t\t}\n\t}\n}\n\nclass Scroller {\n\tconstructor(scrollTarget, options, animations) {\n\t\tvar defaultOptions = {\n\t\t\tscrollIsVertical: true,\n\t\t\tactiveMediaQueryList: window.matchMedia('(min-width: 720px)')\n\t\t};\n\n\t\tif(typeof animations === 'undefined') {\n\t\t\tanimations = [];\n\t\t}\n\n\t\tthis.scrollTarget = scrollTarget;\n\t\tthis.animations = animations;\n\t\tthis.options = Object.assign({}, defaultOptions, options);\n\t\tthis.activated = false;\n\n\t\tthis.respond();\n\n\t\tthis.options.activeMediaQueryList.addListener(() => {\n\t\t\tthis.respond();\n\t\t});\n\t}\n\n\trelativeScrollPosition() {\n\t\tvar offset, size, windowSize, scrollPos, scroll;\n\n\t\tvar rect = this.scrollTarget.getBoundingClientRect();\n\n\t\tif(this.options.scrollIsVertical) {\n\t\t\tif('scrollY' in window) {\n\t\t\t\tscroll = window.scrollY;\n\t\t\t} else if ('pageYOffset' in window) {\n\t\t\t\tscroll = window.pageYOffset;\n\t\t\t} else if (document.documentElement.scrollTop > 0) {\n\t\t\t\tscroll = document.documentElement.scrollTop;\n\t\t\t} else {\n\t\t\t\tscroll = document.body.scrollTop;\n\t\t\t}\n\t\t\toffset = rect.top + scroll;\n\t\t\tsize = rect.height;\n\t\t\twindowSize = window.innerHeight;\n\t\t\tscrollPos = window.pageYOffset;\n\t\t} else {\n\t\t\tif('scrollX' in window) {\n\t\t\t\tscroll = window.scrollX;\n\t\t\t} else if ('pageXOffset' in window) {\n\t\t\t\tscroll = window.pageXOffset;\n\t\t\t} else if (document.documentElement.scrollLeft > 0) {\n\t\t\t\tscroll = document.documentElement.scrollLeft;\n\t\t\t} else {\n\t\t\t\tscroll = document.body.scrollLeft;\n\t\t\t}\n\t\t\toffset = rect.left + scroll;\n\t\t\tsize = rect.width;\n\t\t\twindowSize = window.innerWidth;\n\t\t\tscrollPos = window.pageXOffset;\n\t\t}\n\n\t\tvar zeroPoint = offset - windowSize;\n\t\tvar completePoint = offset + size;\n\t\treturn (scrollPos - zeroPoint) / (completePoint - zeroPoint);\n\t}\n\n\tclampedRelativeScrollPosition() {\n\t\tconsole.log(Math.min(Math.max(this.relativeScrollPosition(), 0), 1));\n\t\treturn Math.min(Math.max(this.relativeScrollPosition(), 0), 1);\n\t}\n\n\tsetUpAnimations() {\n\t\tthis.animations.forEach(animation => {\n\t\t\tanimation.animateTargets.forEach(animateTarget => {\n\t\t\t\tanimateTarget.classList.add('scroll-animated');\n\t\t\t\tanimation.updateCSS(this.clampedRelativeScrollPosition())\n\n\t\t\t\tanimation.listeners.push(() => {\n\t\t\t\t\tvar relativeScrollPosition = this.relativeScrollPosition();\n\t\t\t\t\tif(relativeScrollPosition > -0.2 || relativeScrollPosition < 1.2) {\n\t\t\t\t\t\tanimation.requestUpdate(this.clampedRelativeScrollPosition());\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\twindow.addEventListener('scroll', animation.listeners[animation.listeners.length - 1]); // // FIXME: Throttle scroll to requestAnimationFrame\n\t\t\t});\n\t\t});\n\t}\n\n\tactivate() {\n\t\tif(!this.activated) {\n\t\t\tthis.setUpAnimations();\n\t\t\tthis.activated = true;\n\t\t}\n\t}\n\n\tdeactivate() {\n\t\tif(this.activated) {\n\t\t\tthis.animations.forEach((animation) => {\n\t\t\t\tanimation.listeners.forEach((listener) => {\n\t\t\t\t\twindow.removeEventListener('scroll', listener);\n\t\t\t\t});\n\n\t\t\t\tanimation.reset();\n\t\t\t});\n\n\t\t\tthis.activated = false;\n\t\t}\n\t}\n\n\trespond() {\n\t\tif(this.options.activeMediaQueryList.matches) {\n\t\t\tthis.activate();\n\t\t} else {\n\t\t\tthis.deactivate();\n\t\t}\n\t}\n}"]}