{"version":3,"sources":["scroller.js"],"names":["ScrollerAnimationValueSet","options","_classCallCheck","this","defaultOptions","unit","valueFormat","substitutionString","startValue","endValue","Object","assign","ScrollerAnimation","animateTargets","valueSets","properties","valueSetSeparator","length","listeners","scrollPosition","cssValues","forEach","valueSet","push","toString","animateTarget","animateProperty","style","join","Scroller","scrollTarget","animations","scrollIsVertical","activeMediaQueryList","window","matchMedia","activated","respond","addEventListener","offset","size","windowSize","scrollPos","rect","getBoundingClientRect","top","document","body","scrollTop","offsetHeight","innerHeight","pageYOffset","left","scrollLeft","offsetWidth","innerWidth","pageXOffset","zeroPoint","console","log","Math","min","max","relativeScrollPosition","animation","classList","add","updateCSS","clampedRelativeScrollPosition","setUpAnimations","listener","removeEventListener","matches","activate","deactivate"],"mappings":"6XAAMA,0BACL,QAAAA,GAAYC,GAASC,gBAAAC,KAAAH,EACpB,IAAII,IACHC,KAAM,KACNC,YAAa,gBACbC,mBAAoB,IACpBC,WAAY,GACZC,UAAW,GAGZN,MAAKF,QAAUS,OAAOC,UAAWP,EAAgBH,IAI7CW,6BACL,QAAAA,GAAYC,EAAgBZ,EAASa,GAAWZ,gBAAAC,KAAAS,EAC/C,IAAIR,IACHW,YAAa,YAAa,eAC1BC,kBAAmB,UAGI,KAAdF,GAA8BA,EAAUG,SACjDH,GAAc,GAAId,6BAGnBG,KAAKF,QAAUS,OAAOC,UAAWP,EAAgBH,GACjDE,KAAKW,UAAYA,EACjBX,KAAKU,eAAiBA,EACtBV,KAAKe,sEAGIC,GACT,GAAIC,KAEJjB,MAAKW,UAAUO,QAAQ,SAAUC,GAChCF,EAAUG,OACPD,EAASb,SAAWa,EAASd,YAAcW,EAAiBG,EAASd,YAAYgB,WAAaF,EAASjB,QAI3GF,KAAKU,eAAeQ,QAAQ,SAASI,GACpCtB,KAAKF,QAAQc,WAAWM,QAAQ,SAASK,GACxCD,EAAcE,MAAMD,GAAmBN,EAAUQ,KAAKzB,KAAKF,QAAQe,oBACjEb,OACDA,eAIC0B,oBACL,QAAAA,GAAYC,EAAc7B,EAAS8B,GAAY7B,gBAAAC,KAAA0B,EAC9C,IAAIzB,IACH4B,kBAAkB,EAClBC,qBAAsBC,OAAOC,WAAW,2BAGhB,KAAfJ,IACTA,MAGD5B,KAAK2B,aAAeA,EACpB3B,KAAK4B,WAAaA,EAClB5B,KAAKF,QAAUS,OAAOC,UAAWP,EAAgBH,GACjDE,KAAKiC,WAAY,EAEjBjC,KAAKkC,UAELlC,KAAKF,QAAQgC,qBAAqBK,iBAAiB,SAAU,WAC5DnC,KAAKkC,oFAKN,GAAIE,GAAQC,EAAMC,EAAYC,EAE1BC,EAAOxC,KAAK2B,aAAac,uBAE1BzC,MAAKF,QAAQ+B,kBACfO,EAASI,EAAKE,IAAMC,SAASC,KAAKC,UAClCR,EAAOrC,KAAK2B,aAAamB,aACzBR,EAAaP,OAAOgB,YACpBR,EAAYR,OAAOiB,cAEnBZ,EAASI,EAAKS,KAAON,SAASC,KAAKM,WACnCb,EAAOrC,KAAK2B,aAAawB,YACzBb,EAAaP,OAAOqB,WACpBb,EAAYR,OAAOsB,YAGpB,IAAIC,GAAYlB,EAASE,CAEzB,QAAQC,EAAYe,IADAlB,EAASC,EACqBiB,6DAKlD,MADAC,SAAQC,IAAIC,KAAKC,IAAID,KAAKE,IAAI3D,KAAK4D,yBAA0B,GAAI,IAC1DH,KAAKC,IAAID,KAAKE,IAAI3D,KAAK4D,yBAA0B,GAAI,+CAI5D5D,KAAK4B,WAAWV,QAAQ,SAAS2C,GAChCA,EAAUnD,eAAeQ,QAAQ,SAASI,GACzCA,EAAcwC,UAAUC,IAAI,mBAC5BF,EAAUG,UAAUhE,KAAKiE,iCAEzBJ,EAAU9C,UAAUK,KAAK,WACxByC,EAAUG,UAAUhE,KAAKiE,mCAG1BlC,OAAOI,iBAAiB,SAAU0B,EAAU9C,UAAU8C,EAAU9C,UAAUD,OAAS,KACjFd,OACDA,2CAICA,KAAKiC,YACRjC,KAAKkE,kBACLlE,KAAKiC,WAAY,0CAKfjC,KAAKiC,YACPjC,KAAK4B,WAAWV,QAAQ,SAAS2C,GAChCA,EAAU9C,UAAUG,QAAQ,SAASiD,GACpCpC,OAAOqC,oBAAoB,SAAUD,OAIvCnE,KAAKiC,WAAY,uCAKfjC,KAAKF,QAAQgC,qBAAqBuC,QACpCrE,KAAKsE,WAELtE,KAAKuE","file":"scroller.min.js","sourcesContent":["class ScrollerAnimationValueSet {\n\tconstructor(options) {\n\t\tvar defaultOptions = {\n\t\t\tunit: 'vh',\n\t\t\tvalueFormat: 'translateY(_)',\n\t\t\tsubstitutionString: '_',\n\t\t\tstartValue: 20,\n\t\t\tendValue: -20\n\t\t}\n\n\t\tthis.options = Object.assign({}, defaultOptions, options);\n\t}\n}\n\nclass ScrollerAnimation {\n\tconstructor(animateTargets, options, valueSets) {\n\t\tvar defaultOptions = {\n\t\t\tproperties: ['transform', 'msTransform'],\n\t\t\tvalueSetSeparator: ', '\n\t\t}\n\n\t\tif(typeof valueSets === 'undefined' || !valueSets.length) {\n\t\t\tvalueSets = [ new ScrollerAnimationValueSet ];\n\t\t}\n\n\t\tthis.options = Object.assign({}, defaultOptions, options);\n\t\tthis.valueSets = valueSets;\n\t\tthis.animateTargets = animateTargets;\n\t\tthis.listeners = [];\n\t}\n\n\tupdateCSS(scrollPosition) {\n\t\tvar cssValues = [];\n\n\t\tthis.valueSets.forEach(function (valueSet) {\n\t\t\tcssValues.push(\n\t\t\t\t((valueSet.endValue - valueSet.startValue) * scrollPosition + valueSet.startValue).toString() + valueSet.unit\n\t\t\t);\n\t\t});\n\n\t\tthis.animateTargets.forEach(function(animateTarget) {\n\t\t\tthis.options.properties.forEach(function(animateProperty) {\n\t\t\t\tanimateTarget.style[animateProperty] = cssValues.join(this.options.valueSetSeparator);\n\t\t\t}, this);\n\t\t}, this);\n\t}\n}\n\nclass Scroller {\n\tconstructor(scrollTarget, options, animations) {\n\t\tvar defaultOptions = {\n\t\t\tscrollIsVertical: true,\n\t\t\tactiveMediaQueryList: window.matchMedia('(min-width: 720px)')\n\t\t};\n\n\t\tif(typeof animations === 'undefined') {\n\t\t\tanimations = [];\n\t\t}\n\n\t\tthis.scrollTarget = scrollTarget;\n\t\tthis.animations = animations;\n\t\tthis.options = Object.assign({}, defaultOptions, options);\n\t\tthis.activated = false;\n\n\t\tthis.respond();\n\n\t\tthis.options.activeMediaQueryList.addEventListener('change', function() {\n\t\t\tthis.respond()\n\t\t});\n\t}\n\n\trelativeScrollPosition() {\n\t\tvar offset, size, windowSize, scrollPos;\n\n\t\tvar rect = this.scrollTarget.getBoundingClientRect();\n\n\t\tif(this.options.scrollIsVertical) {\n\t\t\toffset = rect.top + document.body.scrollTop;\n\t\t\tsize = this.scrollTarget.offsetHeight;\n\t\t\twindowSize = window.innerHeight;\n\t\t\tscrollPos = window.pageYOffset;\n\t\t} else {\n\t\t\toffset = rect.left + document.body.scrollLeft;\n\t\t\tsize = this.scrollTarget.offsetWidth;\n\t\t\twindowSize = window.innerWidth;\n\t\t\tscrollPos = window.pageXOffset;\n\t\t}\n\n\t\tvar zeroPoint = offset - windowSize;\n\t\tvar completePoint = offset + size;\n\t\treturn (scrollPos - zeroPoint) / (completePoint - zeroPoint);\n\t}\n\n\tclampedRelativeScrollPosition() {\n\t\tconsole.log(Math.min(Math.max(this.relativeScrollPosition(), 0), 1));\n\t\treturn Math.min(Math.max(this.relativeScrollPosition(), 0), 1);\n\t}\n\n\tsetUpAnimations() {\n\t\tthis.animations.forEach(function(animation) {\n\t\t\tanimation.animateTargets.forEach(function(animateTarget) {\n\t\t\t\tanimateTarget.classList.add('scroll-animated');\n\t\t\t\tanimation.updateCSS(this.clampedRelativeScrollPosition())\n\n\t\t\t\tanimation.listeners.push(function() {\n\t\t\t\t\tanimation.updateCSS(this.clampedRelativeScrollPosition());\n\t\t\t\t});\n\n\t\t\t\twindow.addEventListener('scroll', animation.listeners[animation.listeners.length - 1]); // // FIXME: Throttle scroll to requestAnimationFrame\n\t\t\t}, this);\n\t\t}, this);\n\t}\n\n\tactivate() {\n\t\tif(!this.activated) {\n\t\t\tthis.setUpAnimations();\n\t\t\tthis.activated = true;\n\t\t}\n\t}\n\n\tdeactivate() {\n\t\tif(this.activated) {\n\t\t\tthis.animations.forEach(function(animation) {\n\t\t\t\tanimation.listeners.forEach(function(listener) {\n\t\t\t\t\twindow.removeEventListener('scroll', listener);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.activated = false;\n\t\t}\n\t}\n\n\trespond() {\n\t\tif(this.options.activeMediaQueryList.matches) {\n\t\t\tthis.activate();\n\t\t} else {\n\t\t\tthis.deactivate();\n\t\t}\n\t}\n}"]}